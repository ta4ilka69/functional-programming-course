# Лабораторная работа №2

- **Студент**: Балин Артем Алексеевич
- **Группа**: P3312
- **ИСУ**: 367854
- **Вариант**: 2

---

## Цель работы
Основной целью лабораторной работы является освоение пользовательских типов данных, полиморфизма, рекурсивных алгоритмов, а также техник тестирования, таких как unit-тестирование и property-based тестирование. Также важно научиться разделять интерфейс и реализацию.

В рамках работы реализована структура данных `AVLBag` и функции для работы с ней

## Требования к разработанному ПО

### Реализованный интерфейс:
- **Добавление элементов**
- **Удаление элементов**
- **Фильтрация**: возможность отбора элементов по заданному предикату
- **Отображение** (map): возможность применения функции ко всем элементам
- **Свертка** (левая и правая): для накопления значений в структуре данных
- **Моноидальные свойства**: структура `AVLBag` является моноидом

### Дополнительные требования:
- Структура данных `AVLBag` является **неизменяемой** (immutable).
- Поддержка полиморфизма: `AVLBag` реализован в общем виде, чтобы поддерживать различные типы данных.

## Ключевые элементы реализации

### Основная структура данных: `AVLBag`

Модуль `AvlBag.hs` содержит реализацию структуры данных `AVLBag`, которая представляет собой сбалансированное AVL-дерево с возможностью хранения количества дубликатов для каждого элемента:

- **Вставка элементов** (`insert`): добавляет элемент в дерево, сохраняя баланс.
- **Удаление элементов** (`delete`): удаляет один экземпляр элемента из дерева, при необходимости проводя балансировку.
- **Фильтрация** (`filterAVLBag`): создаёт новое дерево, содержащее только элементы, удовлетворяющие заданному предикату.
- **Отображение** (`mapAVLBag`): применяет функцию ко всем элементам дерева.
- **Свертки** (`foldlAVLBag`, `foldrAVLBag`): функции для левого и правого накопления значений в структуре `AVLBag`.
- **Моноидальные свойства**: реализованы операции объединения (`<>`) и пустого дерева (`mempty`).

### Модуль PropertyBasedTest.hs

Реализованы property-based тесты с использованием библиотеки `QuickCheck`, проверяющие следующие свойства:

- **Свойство идентичности** (`prop_identity`): `mempty` является нейтральным элементом.
- **Свойство ассоциативности** (`prop_associativity`): объединение моноидов ассоциативно.
- **Согласованность сверток** (`prop_foldConsistency`): левая и правая свертки дают одинаковый результат.

### Модуль UnitTest.hs

Реализованы unit-тесты для функций `AVLBag`:

- **Тест вставки элементов**
- **Тест удаления элементов**
- **Тест фильтрации и отображения**
- **Тесты для различных типов данных**: для целых чисел, символов и строк.

### Main.hs

Файл `Main.hs` запускает все unit- и property-based тесты, обеспечивая автоматическую проверку корректности работы.

## Результаты тестирования

Unit-тесты и property-based тесты прошли успешно, что подтвердило корректность работы всех функций в соответствии с требованиями. Тесты показали:

- Удовлетворение свойствам моноида (идентичность и ассоциативность).
- Правильное поведение операций фильтрации, отображения и сверток.
- Корректное функционирование вставки и удаления.

## Вывод

В ходе выполнения лабораторной работы удалось освоить построение пользовательских типов данных, их полиморфную реализацию и поддержание неизменяемости. Сбалансированное AVL-дерево, реализованное в качестве `AVLBag`, соответствует требованиям к интерфейсу `Bag` и поддерживает все необходимые функции. Использование property-based и unit-тестирования позволило убедиться в корректности работы структуры, особенно с точки зрения алгебраических свойств моноида и согласованности операций.
